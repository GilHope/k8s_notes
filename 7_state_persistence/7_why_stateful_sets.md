# Why Stateful Sets?

## Overview

Before we discuss Stateful Sets it is important to understand why we might need them in the first place.

Forget everything for a moment and lets start by thinking of a simple physical server...

For this exmaple, say we are tasked to deploy a database server...

So, we install and setup MySQL to create that database...

With it now up and running, our database can now be written to by other applications...

In order to withstand failures, we need to deploy this database in a highly available way...

So, we deploy additional servers setup with MySQL...

But how we do we replicate the data on the first database server to these new ones?

There are different ways to go about this, but one way would be to setup a single master multi slave topology... To do that you would have all writes come into the master server and then have all reads through them all... You would first clone your data from the master to the first slave... After that you would enable continuous replication on the slave 1 so that it is always in sync with the master... Then you could do it the same way with the rest of your slave servers, but in order to save resources on the master server it would be best to perform the same operations from slave 1 to slave 2 and then so on to another subsequent slave servers as necessary... This noting that you still want to enable continuous replication with the master server for slave 2...

Now, thinking instead in the context of the Kubernetes world, in a K8s deployment instead we will be using pods... And pods all come up simultaneously... So, we will need a way to designate the master and slave pods before doing so... And we need a way to do so with static host names as we know that as pods scale up, scale down, are created and destroyed they will be assigned new addresses and random names... 

### This is where Stateful Sets come into play...

Stateful sets are similar to deployment sets in that they are created on a template, they can scale up and down, perform rolling updates and rollbacks, and etc but there are some differences...

__With stateful sets pods are created in a sequential order...__

After your first pod is deployed via a stateful set, the stateful set must wait until the first one is up and running before it can deploy subsequent pods...

So, that is helpful to ensuring that the master can be deployed first before its slaves...

__Stateful sets assign an unique ordinal index to each pod name... starting from 0 for the first pod and increments of 1 for each subsequent... ex- mysql-0, mysql-1, mysql-2__

So, no more random names...

These identities are sticky so if mysql-0 were to fail and a new pod be recreated to take its place it will get the same exact name...

Furthermore, after a full stateful set is deployed, the slave pods automatically know to make copies off each other rather than burdening the master...

That is why you need stateful sets.