# Headless Services

## Overview

In the previous topic, we discussed the sequential deployment order of Stateful Set and that each pod in your deployment therefore will be assigned a numbered naming convention... For example, mysql-0 (master), mysql-1 (slave 1), mysql-2 (slave 2)...

So, you can point your slaves to reach the master... And as discusses elsewhere, the way you point one application within the cluster to another is through Services...

Therefore, if we have a web server and a database then the way to point the server to the database would be thorugh a service...

In this example, we will name the database, mysql...

Services act as load balancers so the traffic coming into the service will be balanaced across all of the pod applications...

The service has a Cluster IP associated with it which typically would be named along the lines of 'mysql.default.svc.cluster.local'...

So, any other application within the environment can use this DNS name, such as the web server, to reach the service...

As discussed in the previous, the master can handle both reads and writes while the slaves can only handle reads...

So, you want to point the web server to the master only...

As the IP addresses in your cluster are dynamic and this meaning that if a pod fails and needs to be recreated then it will be assigned a new IP so that is not a good way to go about this...

Instead, __thats what we use Headless Services for!__

A headless service is created just like a normal service, except it does not have an IP of its own and it does not perform any load balancing...

All it does it __create DNS entries for each pod using their pod names and a subdomain__...

So, when you create a headless service, lets call it, mysql-h, each pod will get a DNS record and in this case something along the lines of 'mysql-0.mysql-h.default.svc.cluster.local'...

Now the web server can be pointed to your master via this DNS name...

## Configuration

Just like creating a regular service file, except set 'clusterIP: to 'None'...

Then, in your pod configuration files, under 'spec:' add a field for 'subdomain:' and name it the same as the 'name:' in your headless service file, in this example, 'mysql-h'...

Then, also in your pod config file under the 'spec:' section, add a 'hostname:' field and name it something like 'mysql-pod' in this example...

But wait, since the slave pods are created with continuous replication from the master, would that not mean that they would then also be served the same name of 'mysql-pod'?

__No.__

As this is all performed within Stateful Sets, the stateful set when utilizing these fields within the pods config files knows intuitively to automatically create your subsequent pods from the master with iteratively numbered naming conventions for their hostnames as well, so 'mysql-1' would get 'mysql-pod-1' and so on...

But wait, what if I have multiple headless services within my stateful set? How does it know which to use in each situation?

Simply, add a 'serviceName:' field under the 'spec:' section within your stateful set config file... Easy.